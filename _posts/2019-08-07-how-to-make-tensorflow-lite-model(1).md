---
layout: post
title: "Tensorflow Lite 모델 만들기(1)"
date: 2019-08-07
lastmod : 2019-08-08 09:16:00
sitemap :
changefreq : daily
priority : 1.0
---

안녕하세요. 코딩벅스입니다.   <br><br><br>

**Tensorflow Lite**(이하 텐서플로우 라이트)는 기존 텐서플로우의 경량화 버전입니다. 

텐서플로우 라이트를 사용해서 스마트폰과 같은 임베디드 시스템에서 기존 텐서플로우 모델을 

사용할 수 있도록 합니다. 스마트 폰은 하드웨어 성능이 열세하기 때문에,  

서버나 PC와 같이 GPU가 장착이 가능한 고성능 장치에서 텐서플로우로 학습을 진행하고, 

여기서 생성한 텐서플로우 모델을 텐서플로우 라이트에서 인식이 가능한 포맷(*.tflite)으로 변환 후, 

이를 추론(Inference)에 사용합니다. 

<br><br>

위에서 언급한 내용에 대한 설명은 광범위하기에, 다음과 같이 세 단계로 연재하려고 합니다. 

<br><br>

(1) 텐서플로우 모델(**SavedModel**) 생성하기

(2) 텐서플로우 라이트 모델(**.tflite**)로 변환하기 

(3) 안드로이드 앱에 적용하기

<br><br>

우선, 이번 포스트에서는 **(1) 텐서플로우 모델 생성하기**를 다루고자 합니다. 

저장해야 할 텐서플로우 모델의 포맷은 **SavedModel** 또는 **GraphDef**입니다.

텐서플로우 학습 모델은 **그래프**로 표현됩니다. 

결국, 이러한 그래프의 노드와 에지 정보가 어떻게 보면 해당 모델을 표현한다고 볼 수 있죠.

<br><br>

#### CheckPoint Vs. SavedModel

텐서플로우로 학습한 모델을 저장할 때, 보통 **Checkpoint(.ckpt)**형태로 저장합니다. 

그리고 이를 가지고 복원(Restore)해서 다시 학습을 재개합니다. 다만, Checkpoint는 

저장 시점의 모델의 Variable 정보만을 가지고 있기 때문에, 기존 Checkpoint를 복원 하기 전, 

그래프를 다시 정의해주어야 합니다. 

<br>

이와는 달리 **SavedModel**은 Variables 뿐만 아니라 Graph에 대한 정보를 포함하고 있고, 

저장형태는 디렉토리입니다. 모델에 대한 모든 정보를 가지고 있기 때문에, 모델 설계를 위한 

별도 코드를 공유하지 않고도, **SavedModel**을 통해서 모델을 복원할 수 있어서 배포에 

유용합니다. 텐서플로우에서 **SavedModel**에 대한 자세한 설명은 차후 별도의 포스트에서 

다루기로 하겠습니다. 이번 포스트에서는 SavedModel을 활용하여 모델을 배포하는 간단한 예제를

공유하고자 합니다. 

<br><br>

[MNIST 학습 모델에 대한 SavedModel 생성](/assets/main.py)

<br><br>

![SavedModel 생성결과](/assets/img/savedmodel_captured.jpg)

